<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Historial de Usuario - Admin</title>
  <link href="{{ url_for('static', filename='css/output.css') }}" rel="stylesheet">
</head>
<body style="background: linear-gradient(135deg, rgba(180, 83, 9, 0.9) 0%, rgba(217, 119, 6, 0.8) 50%, rgba(245, 158, 11, 0.9) 100%), url('https://images.unsplash.com/photo-1587595431973-160d0d94add1?w=1920&q=80') center/cover fixed; min-height: 100vh;">
  
  <!-- Navbar Admin -->
  <nav class="bg-gradient-to-r from-amber-600 to-amber-700 text-white shadow-lg">
    <div class="max-w-7xl mx-auto px-4 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center">
          <h1 class="text-3xl font-black tracking-tight">
            <span class="text-white">PANEL</span>
            <span class="text-amber-300"> ADMINISTRATIVO</span>
          </h1>
        </div>
        <div class="flex items-center space-x-6">
          <span class="text-amber-100">{{ session.admin_nombre }}</span>
          <a href="{{ url_for('admin_logout') }}" class="bg-amber-900 hover:bg-amber-800 px-4 py-2 rounded-lg transition">
            Cerrar Sesi√≥n
          </a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Men√∫ de navegaci√≥n -->
  <div class="bg-gradient-to-r from-white to-amber-50 shadow-md">
    <div class="max-w-7xl mx-auto px-4">
      <div class="flex space-x-4 py-3">
        <a href="{{ url_for('admin_dashboard') }}" class="px-6 py-2 bg-gray-600 text-white font-semibold rounded-lg hover:bg-amber-600 hover:scale-105 transition-all">
          Dashboard
        </a>
        <a href="{{ url_for('admin_usuarios') }}" class="px-6 py-2 bg-amber-600 text-white font-bold rounded-lg hover:bg-amber-700 hover:scale-105 transition-all shadow-md">
          Usuarios
        </a>
        <a href="{{ url_for('admin_platos') }}" class="px-6 py-2 bg-gray-600 text-white font-semibold rounded-lg hover:bg-amber-600 hover:scale-105 transition-all">
          Platos
        </a>
        <a href="{{ url_for('admin_reservas') }}" class="px-6 py-2 bg-gray-600 text-white font-semibold rounded-lg hover:bg-amber-600 hover:scale-105 transition-all">
          Reservas
        </a>
      </div>
    </div>
  </div>

  <!-- Contenido principal -->
  <main class="max-w-7xl mx-auto px-4 py-8">
    
    <!-- Bot√≥n volver -->
    <div class="mb-6">
      <a href="{{ url_for('admin_usuarios') }}" class="bg-black/40 border border-amber-700/50 hover:border-amber-500 text-amber-300 hover:text-amber-200 font-semibold px-4 py-2 rounded-lg inline-block transition">
        ‚Üê Volver a Usuarios
      </a>
    </div>

    {% if usuario %}
    <!-- Informaci√≥n del usuario -->
    <div class="bg-black/40 rounded-xl shadow-xl border border-amber-700/30 p-6 mb-6">
      <div class="flex items-center space-x-6">
        <div class="bg-amber-900/50 rounded-full p-6">
          <svg class="w-16 h-16 text-amber-400" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
          </svg>
        </div>
        <div class="flex-1">
          <h2 class="text-3xl font-bold text-amber-300 mb-2">{{ usuario.nombre }} {{ usuario.apellido }}</h2>
          <div class="grid grid-cols-2 gap-4 text-sm text-amber-100">
            <div>
              <p class="font-semibold">Email:</p>
              <p>{{ usuario.correo }}</p>
            </div>
            <div>
              <p class="font-semibold"> DNI:</p>
              <p>{{ usuario.dni }}</p>
            </div>
            <div>
              <p class="font-semibold"> Fecha de Registro:</p>
              <p>{{ usuario.fecha_registro.strftime('%d/%m/%Y %H:%M') if usuario.fecha_registro else 'N/A' }}</p>
            </div>
            <div>
              <p class="font-semibold"> Estado:</p>
              {% if usuario.estado == 'activo' %}
                <span class="px-3 py-1 text-xs font-semibold rounded-full bg-green-600 text-white">
                  ‚úì Activo
                </span>
              {% else %}
                <span class="px-3 py-1 text-xs font-semibold rounded-full bg-red-600 text-white">
                  ‚úó Inactivo
                </span>
              {% endif %}
            </div>
          </div>
        </div>
        <div class="text-center bg-amber-900/30 rounded-lg p-6 border border-amber-700/50">
          <p class="text-4xl font-bold text-amber-400">{{ reservas|length }}</p>
          <p class="text-amber-100 text-sm mt-2">Reservas Totales</p>
        </div>
      </div>
    </div>

    <!-- Historial de reservas -->
    <div class="bg-black/40 rounded-xl shadow-xl border border-amber-700/30 p-6">
      <h3 class="text-2xl font-bold text-amber-300 mb-6"> Historial de Reservas</h3>

      {% if reservas %}
      <div class="space-y-4">
        {% for reserva in reservas %}
        <div class="bg-black/30 border border-amber-700/50 rounded-lg p-4 hover:border-amber-500/70 transition">
          <div class="flex items-start justify-between">
            <div class="flex-1">
              <div class="flex items-center space-x-4 mb-3">
                <span class="text-2xl">üçΩÔ∏è</span>
                <div>
                  <h4 class="text-lg font-semibold text-amber-300">
                    Reserva #{{ reserva.id }}
                  </h4>
                  <p class="text-sm text-amber-100">
                     {{ reserva.fecha.strftime('%d/%m/%Y') if reserva.fecha else 'N/A' }} 
                    ‚Ä¢  {{ reserva.hora_llegada }}
                    ‚Ä¢  {{ reserva.mesa }}
                  </p>
                </div>
              </div>

              <div class="ml-14">
                <p class="text-sm text-amber-100 mb-2">
                  <strong>Cliente:</strong> {{ reserva.nombre }} {{ reserva.apellido }}
                </p>
                <p class="text-sm text-amber-100 mb-2">
                  <strong>Email:</strong> {{ reserva.correo }}
                </p>
                {% if reserva.platos %}
                <p class="text-sm text-amber-100 mb-2">
                  <strong>Platos:</strong> {{ reserva.platos }}
                </p>
                {% endif %}
                {% if reserva.total %}
                <p class="text-sm font-bold text-green-400">
                  üí∞ Total: S/. {{ "%.2f"|format(reserva.total) }}
                </p>
                {% endif %}
              </div>
            </div>

            <div class="text-right">
              <div class="mb-3">
                {% if reserva.estado == 'pendiente' %}
                  <span class="px-3 py-1 text-sm font-semibold rounded-full bg-yellow-600 text-white">
                    ‚è≥ Pendiente
                  </span>
                {% elif reserva.estado == 'confirmada' %}
                  <span class="px-3 py-1 text-sm font-semibold rounded-full bg-blue-600 text-white">
                    ‚úì Confirmada
                  </span>
                {% elif reserva.estado == 'completada' %}
                  <span class="px-3 py-1 text-sm font-semibold rounded-full bg-green-600 text-white">
                    ‚úì Completada
                  </span>
                {% else %}
                  <span class="px-3 py-1 text-sm font-semibold rounded-full bg-red-600 text-white">
                    ‚úó Cancelada
                  </span>
                {% endif %}
              </div>
              <p class="text-xs text-amber-200/60">
                Creada: {{ reserva.fecha_creacion.strftime('%d/%m/%Y %H:%M') if reserva.fecha_creacion else 'N/A' }}
              </p>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
      {% else %}
      <div class="text-center py-12 text-amber-200">
        <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
        </svg>
        <p class="text-lg">Este usuario no tiene reservas a√∫n</p>
      </div>
      {% endif %}
    </div>
    {% else %}
    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
      Usuario no encontrado
    </div>
    {% endif %}

  </main>

</body>
</html>
